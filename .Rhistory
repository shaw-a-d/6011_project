theme_void()
rm(tiles)
# Calculate absolute change in capacity
solar_growth <- solar_panel_final |>
group_by(state, year) |>
filter(year %in% c(2014, 2023)) |>
summarise(total_mw = sum(total_mw, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = year,
values_from =  total_mw,
names_prefix = "mw_") |>
mutate(mw_growth = mw_2023 - mw_2014)
mean_rps <- solar_panel_final |>
group_by(state) |>
summarise(mean_rps = mean(rps_target, na.rm = TRUE)*100, .groups = "drop")
solar_growth <- solar_growth |>
left_join(mean_rps, by = "state")
tiles <- us_state_grid1 |>
left_join(solar_growth, by = c("code" = "state"))
View(tiles)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps, height = mean_rps), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
rm(tiles)
solar_growth <- solar_panel_final |>
group_by(state, year) |>
filter(year %in% c(2014, 2023)) |>
summarise(total_mw = sum(total_mw, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = year,
values_from =  total_mw,
names_prefix = "mw_") |>
mutate(mw_growth = mw_2023 - mw_2014)
mean_rps <- solar_panel_final |>
group_by(state) |>
summarise(mean_rps = mean(rps_target, na.rm = TRUE), .groups = "drop")
solar_growth <- solar_growth |>
left_join(mean_rps, by = "state")
# Map ---------------------------------------------------------------------
tiles <- us_state_grid1 |>
left_join(solar_growth, by = c("code" = "state"))
View(tiles)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps, height = mean_rps), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps, height = mean_rps), color = "black") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps, height = mean_rps), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps*100, height = mean_rps*100), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps*20, height = mean_rps*20), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps*2, height = mean_rps*2), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps*5, height = mean_rps*5), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mean_rps, width = mean_rps*5, height = mean_rps*5), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
geom_tile(aes(fill = mean_rps, width = mw_growth, height = mw_growth, color = "white") +
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mean_rps*5, height = mean_rps*5), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mw_growth, height = mean_rps*5), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mw_growth, height = mw_growth), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mw_growth, height = mw_growth/100), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mw_growth, height = mw_growth/10), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth, width = mw_growth/2, height = mw_growth/2), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_minimal()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = rps_target), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mean_rps), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
summary(model_fixed)
summary(model_rps_only)
summary(model_fixed)
str(solar_panel_final)
top_states <- solar_panel_final %>%
group_by(state) %>%
filter(year == max(year)) %>%
arrange(desc(total_mw)) %>%
pull(state)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white") +
geom_text(aes(label = code), size = 3, color = "black") +
scale_fill_viridis_c(name = "Solar Capacity Growth", option = "plasma") +
coord_fixed() +
theme_void()
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = total_mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(avg_rps_target, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "magma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(avg_rps_target, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "magma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(mean_rps, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "magma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(mean_rps*100, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "magma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(mean_rps*100, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "plasma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(mean_rps*100, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "plasma",
direction = 1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
ggplot(tiles, aes(x = col, y = -row)) +
geom_tile(aes(fill = mw_growth), color = "white", width = 0.95, height = 0.95) +
geom_text(aes(label = round(mean_rps*100, 1)), size = 2.8, color = "black") +
scale_fill_viridis_c(
name = "Total Solar MW Growth",
option = "plasma",
direction = -1,
na.value = "gray90"
) +
coord_fixed() +
theme_void() +
labs(title = "State Solar Growth vs Avg RPS Target (2014–2023)",
subtitle = "Label = Avg RPS Target (%)") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
plot.subtitle = element_text(hjust = 0.5, size = 10),
legend.position = "right"
)
solar_growth <- solar_growth |>
mutate(region = tolower(state.name[match(state, state.abb)]))
View(solar_growth)
map <- map_data("state")
map_data <- map |>
left_join(solar_growth, by = "region")
View(map_data)
ggplot(map_data, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = mw_growth), color = "white") +
coord_fixed(1) +
scale_fill_viridis_c(name = "Total Solar Capacity Growth (MW)",
option = "plasma") +
theme_void()
# Map ---------------------------------------------------------------------
library(sf)
library(tigris)
library(dplyr)
library(ggplot2)
library(viridis)
# Map ---------------------------------------------------------------------
install.packages('viridis')
library(sf)
library(tigris)
library(dplyr)
library(ggplot2)
library(viridis)
options(tigris_use_cache = TRUE)
# Get contiguous U.S. states as sf object
states_sf <- states(cb = TRUE, resolution = "20m") |>
filter(!STUSPS %in% c("AK", "HI", "PR"))  # exclude Alaska, Hawaii, Puerto Rico
solar_growth_sf <- solar_growth |>
rename(STUSPS = state)
states_merged <- left_join(states_sf, solar_growth_sf, by = "STUSPS")
ggplot(states_merged) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar", option = "plasma")
states_merge_proj <- st_transform(states_merged, crs = 5070)
ggplot(states_merged_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity Growth (2014-2023)", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\n Growth (2014-2023)", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "magma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma") +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma") +
theme_void() +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "plasma") +
theme_minimal() +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_viridis_c(name = "Total Solar Capacity\nGrowth (2014-2023)", option = "viridis") +
theme_minimal() +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity Growth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity\nGrowth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity\nGrowth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grild = element_blank()
) +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps*100, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity\nGrowth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grild = element_blank()
) +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps*100, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity\nGrowth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grild = element_blank()
) +
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
ggplot(states_merge_proj) +
geom_sf(aes(fill = mw_growth), color = "white") +
geom_sf_text(aes(label = paste0(STUSPS, "\n", round(mean_rps*100, 1), "%")), size = 2.5,
color = "black") +
scale_fill_gradient(
name = "Total Solar Capacity\nGrowth (in mW)",
low = "#f0f0f0",
high = "#1f78b4"
) +
theme_minimal() +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank()
)
labs(title = "Solar Growth vs. Avg RPS Target (2014-2023)")
# Coefficient -------------------------------------------------------------
library(broom)
tidy_model <- broom::tidy(model1, conf.int = TRUE)
tidy_model <- tidy_model |>
filter(term != "(Intercept") |>
arrange(estimate)
ggplot(tidy_model, aes(x = estimate, y = reorder(term, estimate))) +
geom_point(size = 3, color = "#1f78b4") +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2, color = "gray40") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
labs(
title = "Effect of Predictors on Solar MW Growth",
x = "Estimated Coefficient (with 95% CI)",
y = NULL
) +
theme_minimal(base_size = 12)
